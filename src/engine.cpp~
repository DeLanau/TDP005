#include "engine.h"

using namespace sf;

Engine::Engine() :
    window { VideoMode{1280 720, 64 },
    "TDP005", Style::Titlebar | Style::Close},
    current_state{MENU_STATE}

{

    states.insert(std::pair<int, std::unique_ptr<State>>({MENU_STATE, std::make_unique<Menu_State>()}));
    states.insert(std::pair<int, std::unique_ptr<State>>({GAME_STATE, std::make_unique<Game_State>()}));
    states.insert(std::pair<int, std::unique_ptr<State>>({GAME_OVER_STATE, std::make_unique<Game_Over_State>()}));

}

Engine::~Engine()
{
    for (auto s : states)
        delete s.second
}

int Engine::run()
{
    sf::Clock clock;

    while(true)
    {
        current_state = states.at(current_state) -> get_current_state();
        states.at(current_state) -> update();
        window.clear();
        states.at(current_state) -> render(window);
        window.display();
        current_state = states.at(current_state) -> get_next_state();

        window.setFramerateLimit(60);
    }
    
}
